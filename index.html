<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>카르니스 연대기</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=IM+Fell+English:ital@0;1&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#070708;
  --text:#ececec;
  --line:rgba(255,255,255,0.14);
  --blood:#7a1111;

  --paper: rgba(12,12,14,0.86);
  --paper2: rgba(255,255,255,0.035);
  --gold: rgba(210,190,120,0.55);
}

html{ scroll-behavior: smooth; }

body{
  margin:0;
  background: var(--bg);
  color: var(--text);
  font-family: "IM Fell English", Georgia, "Times New Roman", serif;
  overflow-x:hidden;
}

/* 상단 메뉴바 */
.topNav{
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 20;

  display: flex;
  justify-content: center;
  gap: 18px;

  padding: 14px 16px;
  background: rgba(7,7,8,0.75);
  backdrop-filter: blur(6px);
  border-bottom: 1px solid var(--line);

  opacity: 0;
  transform: translateY(-10px);
  pointer-events: none;
  transition: opacity 260ms ease, transform 260ms ease;
}

.topNav.show{
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

.topNav a{
  font-family: "Cinzel", serif;
  color: rgba(236,236,236,0.78);
  text-decoration: none;
  letter-spacing: 2px;
  font-size: 12px;
  padding: 8px 10px;
  border-radius: 10px;
  border: 1px solid transparent;
  transition: opacity 160ms ease, border-color 160ms ease, transform 160ms ease, color 160ms ease, background 160ms ease;
}

.topNav a:hover{
  opacity: 1;
  border-color: rgba(255,255,255,0.18);
  transform: translateY(-1px);
}

.topNav a:active{ transform: translateY(0); }

.topNav a.active{
  color: rgba(236,236,236,1);
  border-color: rgba(210,190,120,0.35);
  background: rgba(210,190,120,0.08);
}

/* 무대 */
.stage{
  position: relative;
  z-index: 3;
  min-height: 100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding: 84px 24px 24px;
}

/* 배경 비네팅 */
.vignette{
  position: fixed;
  inset: 0;
  pointer-events: none;
  background:
    radial-gradient(1200px 900px at 50% 55%, transparent 45%, rgba(0,0,0,0.82) 100%);
  z-index: 1;
}

/* 인트로 */
#intro{
  width:100%;
  max-width:600px;
  text-align:center;
  border:1px solid var(--line);
  border-radius:18px;
  padding:40px 20px;
  background:rgba(255,255,255,0.04);
  transition: opacity 600ms ease;
}

#intro h2{
  font-family: "Cinzel", serif;
  letter-spacing: 2px;
  font-weight: 600;
}

.press{
  margin-top:20px;
  display:inline-block;
  padding:10px 16px;
  border:1px solid rgba(255,255,255,0.3);
  border-radius:10px;
  letter-spacing:3px;
  cursor:pointer;
  font-family: "Cinzel", serif;
  font-size: 12px;
  opacity: 0.9;
}

/* 본문 패널 */
#mainContent{
  text-align: center;
  display:none;
  width:100%;
  max-width:660px;
  border-radius:18px;
  padding:34px 26px;

  background:
    radial-gradient(800px 500px at 50% 0%, rgba(255,255,255,0.05), transparent 55%),
    linear-gradient(180deg, var(--paper2), transparent 35%),
    var(--paper);

  border: 1px solid rgba(255,255,255,0.12);
  box-shadow:
    0 0 0 1px rgba(0,0,0,0.6) inset,
    0 18px 50px rgba(0,0,0,0.55);

  opacity:0;
  transform:translateY(10px);
}

#mainContent.show{ animation:appear 800ms ease forwards; }

@keyframes appear{ to{opacity:1; transform:translateY(0);} }

h1{
  font-family: "Cinzel", serif;
  text-align:center;
  margin: 6px 0 16px;
  letter-spacing: 4px;
  font-weight: 700;
  font-size: 22px;
}

#mainContent h1::after{
  content:"";
  display:block;
  width: 72%;
  height: 1px;
  margin: 14px auto 0;
  background: linear-gradient(90deg, transparent, rgba(210,190,120,0.45), transparent);
}

.myth{
  text-align: center;  
  margin-top: 18px;
}

.myth p{
  line-height: 1.55;     
  margin: 0 0 6px;       
  font-size: 16px;
  letter-spacing: 0.2px;
  color: rgba(236,236,236,0.92);
}

.myth p.blockGap{
  margin-top: 12px;     
}

.myth p:first-child{
  display: inline-block; 
  text-align: left;      
  max-width: 560px;      
}

.myth p:first-child::first-letter{
  float: left;
  font-family: "Cinzel", serif;
  font-weight: 700;
  font-size: 42px;
  line-height: 0.95;
  padding: 6px 10px 0 0;
  color: rgba(210,190,120,0.75);
  text-shadow: 0 0 14px rgba(210,190,120,0.10);
}

/* 5) 강조문장(붉은 문장) 가운데에서 ‘구절’처럼 보이게 */
.myth p strong.blood{
  display: inline-block;
  padding: 6px 10px;
  border-top: 1px solid rgba(210,190,120,0.18);
  border-bottom: 1px solid rgba(210,190,120,0.18);
}

/* 붉은 강조 */
.blood{
  color: var(--blood);
  font-weight: 700;
  letter-spacing: 1px;
  text-shadow: 0 0 10px rgba(122,17,17,0.25);
}

.fadeOut{ opacity:0; }

/* 섹션들 */
.sectionTitle{
  margin-top: 26px;
  margin-bottom: 10px;
  font-size: 15px;
  letter-spacing: 3px;
  opacity: 0.92;
  font-family: "Cinzel", serif;
  text-align: center;
}

.sectionBox{
  border-top: 1px solid rgba(210,190,120,0.20);
  padding-top: 16px;
  margin-top: 12px;
  text-align: left;
  line-height: 1.65;
  font-size: 15px;
  opacity: 0.92;
  color: rgba(236,236,236,0.90);
}

.anchorTarget{ scroll-margin-top: 90px; }
</style>
</head>

<body>

<nav class="topNav" id="topNav">
  <a href="#families" data-section="families">가문</a>
  <a href="#regions" data-section="regions">지역</a>
  <a href="#worldMap" data-section="worldMap">전체 지도</a>
</nav>

<div class="vignette"></div>

<div class="stage">

<section id="intro">
  <h2>태초의 신이 먹힌 밤</h2>
  <div class="press" id="pressBtn">PRESS ENTER</div>
</section>

<section id="mainContent">
  <h1>창세 신화</h1>

  <div class="myth">
    <p>태초에 하나의 신이 세계를 창조하고, 그 위에 군림했다.</p>
    <p>신은 동시에 여러 피조물을 만들어 자신이 만든 땅을 돌보게 했다.</p>

    <p class="blockGap">그러나 시간이 흐르며 피조물들 사이에는 불만이 싹트기 시작했다.</p>
    <p>그리고 어느 날, 한 피조물의 선동에 의해 그들은 잠든 신을 덮쳤다.</p>
    <p>피조물들은 신의 육신을 다섯 조각으로 나누어, 그것을 먹었다.</p>

    <p class="blockGap"><strong class="blood">눈, 혀, 심장, 뼈, 그리고 피.</strong></p>

    <p class="blockGap">신을 집어삼킨 순간, 그들은 절대적인 권능을 하나씩 계승했다.</p>
    <p>눈을 먹은 자는 미래를 꿰뚫어보는 예지력을 얻었고,</p>
    <p>혀를 먹은 자는 세계를 굴복시키는 언령을 손에 넣었다.</p>
    <p>심장을 먹은 자는 죽지 않는 생명을,</p>
    <p>뼈를 먹은 자는 파괴되지 않는 육신을,</p>
    <p>피를 마신 자는 절대적인 혈맹의 권능을 얻었다.</p>

    <p class="blockGap">한낱 피조물에 불과하던 그들은 이제 신의 힘을 행사하는 존재가 되었고,</p>
    <p>스스로를 ‘신식자(神食者)’라 칭하며</p>
    <p>신이 창조한 세계를 나누어 통치하기 시작했다.</p>

    <p class="blockGap">그러나 그들은 미처 깨닫지 못했다.</p>
    <p>신이 먹힌 그 자리에 남아 있던 것,</p>
    <p>‘그림자’의 존재를.</p>

    <p class="blockGap">그 그림자를 훔쳐 달아난 또 다른 피조물이 있었다.</p>
    <p>그는 신식자들의 지배가 미치지 않는 세계의 경계로 숨어들어,</p>
    <p>잊힌 신의 부활을 준비하기 시작했다.</p>
  </div>

  <h2 id="families" class="sectionTitle anchorTarget">가문</h2>
  <div class="sectionBox">
    <p>여기에 ‘눈/혀/심장/뼈/피’ 가문 소개 내용을 넣으면 돼.</p>
    <p>예: 특징, 영토, 대표 인물, 금기, 권능 등.</p>
  </div>

  <h2 id="regions" class="sectionTitle anchorTarget">지역</h2>
  <div class="sectionBox">
    <p>여기에 북부 산맥, 남부 평야, 중앙 요충지, 동부 불모지, 서부 음지 같은 지역 정보를 넣으면 돼.</p>
  </div>

  <h2 id="worldMap" class="sectionTitle anchorTarget">전체 지도</h2>
  <div class="sectionBox">
    <p>여기는 지도 이미지(나중에 &lt;img&gt;)나, 간단한 텍스트 지도를 넣는 자리.</p>
  </div>
</section>

</div>

<audio id="bgm" autoplay loop muted>
  <source src="bgm.mp3" type="audio/mpeg">
</audio>

<div id="audioControl">
  <button id="bgmToggle" aria-label="BGM Toggle">
    <svg id="playIcon" viewBox="0 0 24 24">
      <polygon points="8,5 19,12 8,19"></polygon>
    </svg>
    <svg id="pauseIcon" viewBox="0 0 24 24" style="display:none;">
      <rect x="6" y="5" width="4" height="14"></rect>
      <rect x="14" y="5" width="4" height="14"></rect>
    </svg>
  </button>

  <input type="range" id="volumeSlider" min="0" max="100" value="50">
</div>

<style>
#audioControl{
  position: fixed;
  bottom: 20px;
  right: 20px;
  z-index: 10;
  display: flex;
  align-items: center;
  gap: 14px;
}

#volumeSlider{
  width: 120px;
  -webkit-appearance: none;
  appearance: none;
  background: transparent;
  cursor: pointer;
}

#volumeSlider::-webkit-slider-runnable-track{
  height: 2px;
  background: rgba(255,255,255,0.4);
  border-radius: 2px;
}

#volumeSlider::-moz-range-track{
  height: 2px;
  background: rgba(255,255,255,0.4);
  border-radius: 2px;
}

#volumeSlider::-webkit-slider-thumb{
  -webkit-appearance: none;
  width: 10px;
  height: 10px;
  background: white;
  border-radius: 50%;
  margin-top: -4px;
  transition: transform 0.2s ease;
}

#volumeSlider::-moz-range-thumb{
  width: 10px;
  height: 10px;
  background: white;
  border-radius: 50%;
  border: none;
  transition: transform 0.2s ease;
}

#volumeSlider:hover::-webkit-slider-thumb{ transform: scale(1.2); }
#volumeSlider:hover::-moz-range-thumb{ transform: scale(1.2); }

#bgmToggle{
  background: none;
  border: none;
  cursor: pointer;
  padding: 0;
  display: flex;
  align-items: center;
}

#bgmToggle svg{
  width: 22px;
  height: 22px;
  fill: white;
  opacity: 0.6;
  transition: opacity 0.2s ease, transform 0.2s ease;
}

#bgmToggle:hover svg{
  opacity: 1;
  transform: scale(1.1);
}
</style>

<script>
const intro = document.getElementById("intro");
const mainContent = document.getElementById("mainContent");
const pressBtn = document.getElementById("pressBtn");
const bgm = document.getElementById("bgm");
const volumeSlider = document.getElementById("volumeSlider");
const bgmToggle = document.getElementById("bgmToggle");

const playIcon = document.getElementById("playIcon");
const pauseIcon = document.getElementById("pauseIcon");

const topNav = document.getElementById("topNav");
const navLinks = topNav.querySelectorAll("a[data-section]");
const sectionIds = ["families", "regions", "worldMap"];
const sectionEls = sectionIds.map(id => document.getElementById(id)).filter(Boolean);

let started = false;
let fadeTimer = null;

function getTargetVolume(){ return volumeSlider.value / 100; }

function updateBgmButton(){
  if(bgm.paused){
    playIcon.style.display = "block";
    pauseIcon.style.display = "none";
  } else {
    playIcon.style.display = "none";
    pauseIcon.style.display = "block";
  }
}

function fadeTo(target, duration = 600, onDone){
  if (fadeTimer) clearInterval(fadeTimer);

  const startVol = bgm.volume;
  const diff = target - startVol;
  const steps = Math.max(1, Math.floor(duration / 30));
  let currentStep = 0;

  fadeTimer = setInterval(()=>{
    currentStep++;
    const progress = currentStep / steps;
    bgm.volume = startVol + diff * progress;

    if (currentStep >= steps){
      clearInterval(fadeTimer);
      fadeTimer = null;
      bgm.volume = target;
      if (onDone) onDone();
    }
  }, 30);
}

function setActiveMenu(id){
  navLinks.forEach(a=>{
    a.classList.toggle("active", a.dataset.section === id);
  });
}

let sectionObserver = null;
function setupSectionObserver(){
  if (sectionObserver) sectionObserver.disconnect();

  sectionObserver = new IntersectionObserver((entries)=>{
    const visible = entries
      .filter(e => e.isIntersecting)
      .sort((a,b)=> a.boundingClientRect.top - b.boundingClientRect.top);

    if (visible.length > 0){
      setActiveMenu(visible[0].target.id);
    }
  }, {
    root: null,
    rootMargin: "-90px 0px -55% 0px",
    threshold: 0.01
  });

  sectionEls.forEach(sec => sectionObserver.observe(sec));
  if (sectionEls[0]) setActiveMenu(sectionEls[0].id);
}

function startStory(){
  if(started) return;
  started = true;

  intro.classList.add("fadeOut");

  bgm.muted = false;
  bgm.volume = 0;

  bgm.play().then(()=>{
    fadeTo(getTargetVolume(), 800);
    updateBgmButton();
  }).catch(()=>{});

  setTimeout(()=>{
    intro.style.display="none";
    mainContent.style.display="block";
    mainContent.classList.add("show");

    topNav.classList.add("show");
    setupSectionObserver();
  },500);
}

document.addEventListener("keydown", e=>{
  if(e.key==="Enter") startStory();
});

if(pressBtn) pressBtn.addEventListener("click", startStory);
if(intro) intro.addEventListener("click", startStory);

navLinks.forEach(a=>{
  a.addEventListener("click", ()=>{
    const id = a.dataset.section;
    if (id) setActiveMenu(id);
  });
});

volumeSlider.addEventListener("input", ()=>{
  if(!bgm.paused){
    fadeTo(getTargetVolume(), 200);
  }
});

bgmToggle.addEventListener("click", ()=>{
  if(!started){
    startStory();
    return;
  }

  if(bgm.paused){
    bgm.volume = 0;
    bgm.play().then(()=>{
      fadeTo(getTargetVolume(), 500);
      updateBgmButton();
    });
  } else {
    fadeTo(0, 400, ()=>{
      bgm.pause();
      updateBgmButton();
    });
  }
});

updateBgmButton();
</script>

</body>
</html>
